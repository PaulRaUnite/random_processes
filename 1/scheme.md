# Лабораторная работа 1
Токарев Павел, МФ-31, 15.03.2018

## Формулировка

Есть цепь Маркова, вероятности которой зависят от параметров `i`, `j`, `k`. Обозначения состояний слева направо: Река, Левая нога, На двух ногах, Правая нога, Копья. Начальным состоянием является левая нога(оно особенное на картинке).

![Graph](./Chain.png)

Используя эту цепь, выяснить:
1. среднее время до попадания в невозвратное состояние;
2. вероятность упасть;
3. просимулировать работу цепи и вычислить метрики выше для симуляции и сравнить с теоретическими данными.

## Параметры

- `i` &mdash; 7;
- `j` &mdash; 7;
- `k` &mdash; 5;
- количество симуляций &mdash; 10 000.

<div class="page-break"></div>

## Результаты

- Р - река;
- К - копья;
- Л - на левой ноге;
- С - на двух ногах;
- П - на правой ноге.

### Матрицы
#### P

|   | Р | К | Л | С | П |
|---|---|---|---|---|---|
| Р | {}| {}| {}| {}| {}|
| К | {}| {}| {}| {}| {}|
| Л | {}| {}| {}| {}| {}|
| С | {}| {}| {}| {}| {}|
| П | {}| {}| {}| {}| {}|

#### N = (E - Q)^-1
Среднее время пребывания в состоянии <code>S<sub>j</sub></code> если начинаем в <code>S<sub>i</sub></code>(то есть среднее количество раз когда это состояние будет посещено до того, как попадем в состояние поглощения).

|<code><sub>i</sub>\\<sup>j</sup></code>| Л | С | П |
|---|---|---|---|
| Л | {}| {}| {}|
| С | {}| {}| {}|
| П | {}| {}| {}|

#### B = N*R

Вероятность поглотится в состоянии <code>S<sub>j</sub></code> если начинаем в <code>S<sub>i</sub></code>.

|<code><sub>i</sub>\\<sup>j</sup></code>| Р | К |
|---|---|---|
| Л | {}| {}|
| С | {}| {}|
| П | {}| {}|

### Среднее время устоять:

| Метод         | На левой | На обеих | На правой | Среднее средних |
|---------------|----------|----------|-----------|------|
| теоретический |    {:.5f}    |    {:.5f}    |    {:.5f}     |    {}   |  
| практический  |    {:.5f}    |    {:.5f}    |    {:.5f}     |   {}    |

### Вероятность упасть в/на:

| Метод         | Реку     | Копья    | Сумма |
|---------------|----------|----------|-------|
| теоретический | {:.5f}   | {:.5f}   | {}    |
| практический  | {:.5f}   | {:.5f}   | {}    |
